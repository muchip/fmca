clear all;
close all;
addpath('../');
N = 10000;
P = randn(2, N);
figure(1)
plot(P(1,:), P(2,:), 'r.');
[K,I] = MEXsampletCompressor(P, 3, 0.8, 4, 0);
K = sparse(K(:,1), K(:,2), K(:,3), N, N);
K = K + triu(K,1)';
condest(K)

X = diag();

for i=1:20
    X = X * (2 * II - TT * X);
    X(find(abs(X) < threshold)) = 0;
    X = sparse(X);
    err(i) = norm(TT * X - II,'fro') / n
end

figure(2)
spy(K)